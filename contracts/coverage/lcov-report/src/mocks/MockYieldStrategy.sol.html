<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for src/mocks/MockYieldStrategy.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">all files</a> / <a href="index.html">src/mocks/</a> MockYieldStrategy.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">63.64% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>21/33</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">58.33% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>7/12</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">57.14% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>12/21</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">78.26% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>36/46</span>
      </div>
    </div>
  </div>
  <div class='status-line medium'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">20×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">48×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">48×</span>
<span class="cline-any cline-yes">48×</span>
<span class="cline-any cline-yes">48×</span>
<span class="cline-any cline-yes">48×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">48×</span>
<span class="cline-any cline-yes">48×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">14×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">48×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;
&nbsp;
import "../interfaces/IYieldStrategy.sol";
import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
&nbsp;
/**
 * @title MockYieldStrategy
 * @dev Mock yield strategy for testing purposes
 */
contract MockYieldStrategy is IYieldStrategy {
    using SafeERC20 for IERC20;
&nbsp;
    address public immutable override asset;
    uint256 private _totalAssets;
    uint256 private _totalShares;
    uint256 private _userYield;
    uint256 private _currentAPY = 400; // 4% default
    bool private _shouldFail = false;
&nbsp;
    mapping(address =&gt; uint256) private _balances;
&nbsp;
    constructor(address _asset) {
        asset = _asset;
    }
&nbsp;
    // Test helper functions
    function setUserYield(uint256 amount) external {
        _userYield = amount;
    }
&nbsp;
    function setShouldFail(bool shouldFail) external {
        _shouldFail = shouldFail;
    }
&nbsp;
    function setCurrentAPY(uint256 apy) external {
        _currentAPY = apy;
    }
&nbsp;
    // IYieldStrategy implementation
    function deposit(uint256 amount) external override returns (uint256 shares) {
        IERC20(asset).safeTransferFrom(msg.sender, address(this), amount);
        
        shares = convertToShares(amount);
        _balances[msg.sender] += shares;
        _totalShares += shares;
        _totalAssets += amount;
&nbsp;
        emit Deposit(msg.sender, amount, shares);
        return shares;
    }
&nbsp;
    function withdraw(uint256 shares) external override returns (uint256 amount) {
        require(_balances[msg.sender] &gt;= shares, "Insufficient shares");
        
        amount = convertToAssets(shares);
        _balances[msg.sender] -= shares;
        _totalShares -= shares;
        _totalAssets -= amount;
&nbsp;
        IERC20(asset).safeTransfer(msg.sender, amount);
&nbsp;
        emit Withdrawal(msg.sender, amount, shares);
        return amount;
    }
&nbsp;
    function emergencyWithdraw(address user) external override returns (uint256 amount) {
        uint256 userShares = _balances[user];
        <span class="missing-if-branch" title="if path not taken" >I</span>if (userShares == 0) <span class="cstat-no" title="statement not covered" >return 0;</span>
&nbsp;
        amount = convertToAssets(userShares);
        _balances[user] = 0;
        _totalShares -= userShares;
        _totalAssets -= amount;
&nbsp;
        IERC20(asset).safeTransfer(user, amount);
        return amount;
    }
&nbsp;
    function getCurrentAPY() external view override returns (uint256) {
        return _currentAPY;
    }
&nbsp;
    function calculateUserYield(address user) external view override returns (uint256) {
        if (_shouldFail) {
            revert("Mock strategy failure");
        }
        return _userYield;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function getTotalYieldGenerated() external view override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _userYield;</span>
    }
&nbsp;
    function harvestYield() external override returns (uint256) {
        emit YieldHarvested(_userYield, _totalAssets);
        return _userYield;
    }
&nbsp;
    function convertToShares(uint256 assets) public view override returns (uint256) {
        <span class="missing-if-branch" title="else path not taken" >E</span>if (_totalAssets == 0) return assets;
<span class="cstat-no" title="statement not covered" >        return (assets * _totalShares) / _totalAssets;</span>
    }
&nbsp;
    function convertToAssets(uint256 shares) public view override returns (uint256) {
        <span class="missing-if-branch" title="if path not taken" >I</span>if (_totalShares == 0) <span class="cstat-no" title="statement not covered" >return shares;</span>
        return (shares * _totalAssets) / _totalShares;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function balanceOf(address user) external view override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _balances[user];</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function getStrategyInfo() external view override returns (StrategyInfo memory) {</span>
<span class="cstat-no" title="statement not covered" >        return StrategyInfo({</span>
            name: "Mock Strategy",
            description: "Mock yield strategy for testing",
            totalAssets: _totalAssets,
            totalShares: _totalShares,
            currentAPY: _currentAPY,
            riskScore: 1,
            lastHarvest: block.timestamp,
            active: true
        });
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function totalAssets() external view override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _totalAssets;</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function getRiskScore() external pure override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return 1;</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function getPerformanceData(uint256) external view override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _currentAPY;</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function isProfitable() external pure override returns (bool) {</span>
<span class="cstat-no" title="statement not covered" >        return true;</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function maxCapacity() external pure override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return type(uint256).max;</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function utilizationRate() external view override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _totalAssets &gt; 0 ? (_totalAssets * 10000) / this.maxCapacity() : 0;</span>
    }
}</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Jul 15 2025 00:29:02 GMT+0530 (India Standard Time)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
